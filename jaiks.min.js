/*!
 * jaiks.js v1.1.0
 * (c) 2012 ulrik nielsen
 *
 * A way to bundle ajax requests.
 *
 * Full details and documentation:
 * http://github/mrbase/jaiks
 *
 * License: http://www.opensource.org/licenses/mit-license.php
 */var jaiks=function(e){"use strict";var t={post_var:"payload",async:!0,url:""},n={},r={},i={},s=0;return r.init=function(r){n=e.extend({},t,r)},r.add=function(e,t,r,o){if(0===n.length){window.console&&console.error("jaiks not initialize, use jaiks.init({...});");return}undefined===o&&(o=10),undefined===r&&(r={}),i[e]={weight:o,action:e,callback:t,data:r},s++},r.exec=function(){if(!n.url){window.console&&console.error("jaiks target url not set, use: jaiks.init({url: 'http://..../'}); to initialize");return}if(0===s)return;var t=[];e.each(i,function(e,n){t.push(n)}),t.sort(function(e,t){return e.weight-t.weight}),e("body").trigger("jaiks.loading");var r=JSON.stringify(t),r=encodeURIComponent(r).replace(/[!'()*]/g,escape),o=e.ajax({async:n.async,data:n.post_var+"="+r,dataType:"json",type:"POST",url:n.url});o.done(function(t){e.each(t,function(e,t){i[t.action].callback.call(this,t)})}),o.fail(function(e,t){window.console&&console.log("jaiks failed: ",t)}),o.always(function(){e("body").trigger("jaiks.done")})},r}(jQuery);